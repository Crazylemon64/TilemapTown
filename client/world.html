<html>
<!-- resources -->
<head>
<title>Tilemap Town</title>
<link rel="stylesheet" type="text/css" href="world.css" />
<script src="js/ui.js"></script>
<script src="js/map.js"></script>
<script src="js/predefined.js"></script>
<script src="js/online.js"></script>
</head>
<body onLoad="initWorld();" ondragstart="return false;" ondrop="return false;">

<div id="wrapper" style="background-color: white; display: flex; flex-direction:column;">
<!-- image resources -->
<img src="img/potluck.png" style="display: none;" id="potluck">
<img src="img/extra.png"   style="display: none;" id="extras">
<img src="img/chicago.png" style="display: none;" id="chicago">
<div id="playerAvatars">
</div>

<!-- menu bar -->
<div style="width: 100%; height: 32px;" class="topnav unselectable">
  <a id="navlogin"     href="#">Login</a>
  <a id="navinventory" href="#" onclick="viewInventory();">Inventory</a>
  <a id="navoptions"   href="#" onclick="viewOptions();">Options</a>
  <a id="navmap"       href="#">Map</a>
  <a id="navhelp"      href="#">Help</a>
  <a id="navcustomize" href="#" onclick="viewCustomize();"><div style="width:16px; height:16px; background: url(img/potluck.png) -32px -400px;"></div></a>
</div>

<div id="loginWindow" class="modal">
  <div class="modal-content">
    <span class="modalclose">&times;</span>
    <p>
    <h1>Log into Tilemap Town</h1>
    Leave username and password blank to sign in as a guest.<br>
    <input type="text" id="loginuser" placeholder="Username"> Username<br>
    <input type="password" id="loginpass" placeholder="Password"> Password<br>
    <input type="text" id="loginserver" value="novasquirrel.com/townws/" placeholder="Server"> Server<br>
    <input type="button" value="Connect" onclick="loginButton();"><br>
    </p>
  </div>
</div>

<div id="mapOptionsWindow" class="modal">
  <div class="modal-content">
    <span class="modalclose">&times;</span>
    <p>
    <h1>Map</h1>
    On hold until I figure out how to make this better
<!--
    <input type="text" id="mapname"  placeholder="Map name">Map name<br>
    <input type="text" id="mapowner" placeholder="Map owner" disabled>Map owner<br>
    <input type="text" id="mapid"    placeholder="Map id" disabled>Map id<br>
    </p>

    <p>
    <input type="number" value="100" min="10" max="100" id="mapwidth" size="4" />&times;<input type="number" value="100" min="10" max="100" id="mapheight" size="4" />Map height<br>
    <input type="number" value="3" id="mapstartx" size="4" />&times;<input type="number" value="3" id="mapstarty" size="4" />Start position<br>
    <input type="text" id="mapdefaultturf" placeholder="grass">Default floor<br>
    </p>

    <p>
    <h2>Permissions</h2><br>
    <select>
      <option value="public">Public</option>
      <option value="unlisted">Unlisted</option>
      <option value="whitelist">Private</option>
    </select><br>
    </p>

    <p>
    <input type="button" value="Export" onclick=";">
    <input type="button" value="Import" onclick=";"><br>
-->
    </p>
  </div>
</div>

<div id="editItemWindow" class="modal">
  <div class="modal-content">
    <span class="modalclose">&times;</span>
    <p>
    <h1>Edit tile</h1>

    <p>
    <label for="edittilename" class="unselectable">Item name</label><br>
    <input type="text" id="edittilename"/>
    </p>

    <p>
    Item picture<br>
    <img src="img/transparent.png" width="16" height="16" id="edittilepic" style="background: url(img/potluck.png) 0px 0px;">
    <select id="edittilesheet" onchange="editItemUpdatePic();">
      <option value="0">Potluck</option>
      <option value="1">Extras</option>
      <option value="custom">Custom</option>
    </select>
    <input type="number" value="0" id="edittilex" oninput="editItemUpdatePic();" size="4" />
    <input type="number" value="0" id="edittiley" oninput="editItemUpdatePic();" size="4" />
    <br/>
    <div style="overflow:scroll; width:512px; height:128px;" id="edittilesheetcontainer">
    <img src="" id="edittilesheetselect">
    </div>
    </p>

    <p>
    Item type<br>
    <select id="edittiletype">
      <option value="0">Normal</option>
      <option value="1">Sign</option>
      <option value="2">Door</option>
      <option value="3">Container</option>
      <option value="4">Ice</option>
      <option value="5">Escalator</option>
      <option value="6">Water</option>
    </select>
    </p>

    <p>
    <input type="checkbox" id="edittiledensity"><label for="edittiledensity" class="unselectable">Item is an obstacle (dense)</label></input><br>
    <input type="checkbox" id="edittileobject"><label for="edittileobject" class="unselectable">Item is a map tile</label></input>
    </p>

    <br>
    <input type="button" value="Apply changes" onclick="editItemApply();">
    <input type="button" value="Clone item" onclick="editItemClone();">
    <input type="button" value="Delete item" onclick="editItemDelete();">
    <input type="button" value="Cancel" onclick="editItemCancel();">
    </p>
  </div>
</div>

<!-- interface -->
<div style="display: flex; flex-direction: row; flex-grow: 1; overflow-y: hidden;">
  <!-- left side, map and other stuff -->
  <div>
    <canvas class="unselectable" id="map" width="320" height="320" style="width:320px; height:320px;" imageSmoothingEnabled="false"></canvas><br>
    <canvas class="unselectable" id="selector" width="320" height="16" style="background-color:white;" imageSmoothingEnabled="false"></canvas><br>

    <div style="overflow: auto; max-height: calc(100% - 16px - 320px - 32px);">
      <div id="selectionInfo" style="display:none;">
        <input type="checkbox" id="turfselect" checked="true"><label for="turfselect">Tiles</label></input>
        <input type="checkbox" id="objselect" checked="true"><label for="objselect">Objects</label></input>
        <input type="button" value="Delete" onclick="selectionDelete();">
      </div>
      <div id="panel"></div>
      <div id="inventory" style="display: none;">
        <ul id="inventoryul" class="unselectable">
        </ul>
        <canvas class="unselectable" id="inventoryCanvas" width="320" height="320" oncontextmenu="return false;" imageSmoothingEnabled="false"></canvas>
      </div>
      <div id="options" style="display: none;">
        <input type="checkbox" id="alwayscenter" checked="true"><label for="alwayscenter" class="unselectable">Always center camera</label></input><br>
        <input type="checkbox" id="doublezoom"><label for="doublezoom" class="unselectable">2x zoom</label></input><br>
        <input type="number" id="viewwidth" min="1" max="50" size="2" value="20"><label for="viewwidth">View width</label></input><br>
        <input type="number" id="viewheight" min="1" max="50" size="2" value="20"><label for="viewheight">View height</label></input><br>
        <input type="checkbox" id="audionotify"><label for="audionotify" class="unselectable">Notify when people talk</label></input><br>

        <input type="button" onclick="applyOptions(); viewOptions();" value="OK">
        <input type="button" onclick="applyOptions();" value="Apply changes">
        <input type="button" onclick="viewOptions();" value="Close options">
      </div>
      <div id="character" style="display: none;">
        Character customizer not implemented yet<br>
        <input id="iconPicker" type="file" onchange="previewIcon();"><br>
        <img id="iconPreview" src="" width="32" height="32" alt="Image preview"><br>
        <input type="button" value="Use"><br>
      </div>
    </div>

   </div>

   <!-- right side, chat -->
   <div style="display: flex; flex-direction: column; flex-grow: 1; max-height: calc(100% - 32px);">
     <div id="chatArea" class="chatarea" style="display: block; padding: 2px; overflow-y: scroll; flex-grow: 1;">
     </div>
     <div>
       <input type="text" style="width:100%;" id="chatInput" placeholder="chat here...">
     </div>
   </div>

</div>

</div>
</body>
</html>
